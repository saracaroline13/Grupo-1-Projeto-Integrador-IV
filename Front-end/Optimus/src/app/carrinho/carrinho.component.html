<h3 class="text-center text-white py-3" style="background-color: #0f2058; padding-bottom: 5px; font-weight: 700;">RESUMO
    DA COMPRA
</h3>
<h3 class="text-danger text-center" *ngIf="!logado()">Por favor efetuar o login, para finalizar a compra!</h3>
<div class="container-fluid">


    <!--Informações de entrega-->
    <div class="row d-flex justify-content-center mt-5">
        <div class="col-md-6"  *ngIf="logado()">
            <h4 class="text-center mb-5">ENDEREÇO DE ENTREGA</h4>
            <div class="form">
                <div class="form-row d-flex justify-content-center mb-3 fc-verde font-weight-bold">
                    <div class="col-md-6">
                        <label for="rua">Rua</label>
                        <input [(ngModel)]='rua' name="rua" type="text" class="form-control" id="rua"
                            placeholder="Rua Dois" readonly>
                    </div>
                    <div class="col-md-2">
                        <label for="numero">Número</label>
                        <input [(ngModel)]='numero' type="text" class="form-control" name="numero" id="numero"
                            placeholder="Ex. 100" readonly>
                    </div>
                </div>
                <div class="form-row d-flex justify-content-center mb-3 fc-verde font-weight-bold">
                    <div class="col-md-4">
                        <label for="bairro">Bairro</label>
                        <input [(ngModel)]='bairro' type="text" class="form-control" name="bairro" id="bairro"
                            placeholder="Ex. Jardim Oriental" readonly>
                    </div>
                    <div class="col-md-4">
                        <label for="cep">CEP</label>
                        <input [(ngModel)]='cep' type="text" class="form-control" name="cep" id="cep"
                            placeholder="00000-000" readonly>
                    </div>
                </div>

                <div class="form-row justify-content-center mb-3 fc-verde font-weight-bold">
                    <div class="col-md-3">
                        <label for="telefone">Telefone</label>
                        <input [(ngModel)]="telefone" type="text" class="form-control" name="telefone" id="telefone"
                            placeholder="(11) 9 9999-9999" readonly>
                    </div>
                    <div class="col-md-5">
                        <label for="nomeEntrega">Nome destinatário</label>
                        <input [(ngModel)]="nomeDestinatario" type="text" class="form-control" name="nomeEntrega"
                            id="nomeEntrega" placeholder="Ex. João da Silva" readonly>
                    </div>
                </div>
            </div>
            <div class="row d-flex justify-content-center">
                <div>
                    <div class="card" *ngIf="logado()">
                        <div class="card-body ">
                            <h5 class="card-title">{{ usuario.rua }},{{ usuario.numero }}</h5>
                            <button type="submit" class="btn btn-primary" (click)="selecEndereco()">Selecionar</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="columns my-3 d-flex justify-content-center">
                <div *ngFor='let endereco of listaEnderecos'>
                    <div class="card" *ngIf="enderecoAdicional(endereco.id_cliente)">
                        <div class="card-body ">
                            <h5 class="card-title">{{ endereco.rua }},{{ endereco.numero }}</h5>

                            <button type="submit" class="btn btn-primary"
                                (click)="selecionarEndereco(endereco.id_endereco)">Selecionar</button>
                        </div>
                    </div>
                </div>
            </div>
            <a class="d-flex justify-content-center" [routerLink]="['/endereco-adicional', idUser]">
                <button type="submit" class="btn btn-info mb-4" *ngIf="logado()">Adicionar outro endereço</button>
            </a>
        </div>

        <!--/Informações de entrega-->
        <!--Itens do carrinho-->

        <div class="col-md-6">
            <h4 class="text-center mb-5">CARRINHO</h4>
            <div class="row d-flex justify-content-center mt-5">
                <div style="width: 600px; height: 260px; overflow-y: scroll;">
                    <div *ngFor="let produto of produto" class="card mb-3 mt-1" style="max-width: 540px; border-color: #0f20587e;">
                        <div class="row g-0">
                            <div class="col-md-3 d-md-flex align-items-center d-none">
                                <img width="100px" src={{produto.imgPrincipal}} alt="...">
                            </div>
                            <div class="col-md-5">
                                <div class="card-body">
                                    <h5 class="card-title">{{produto.nome}}</h5>
                                    <p class="card-text"> {{produto.preco | currency:'BRL'}}</p>
                                </div>
                            </div>
                            <div class="col-md-4 d-flex align-items-center justify-content-center">
                                <div class="columns">
                                    <label for="">Quantidade</label>
                                    <!-- <i class="fa fa-times-circle-o ml-4 text-danger" aria-hidden="true" (click)="limparListaCarrinho(produto)"></i> -->
                                    <div class="row">
                                        <p class=" btn btn-info" (click)="addToCarrinho(produto)">+</p>
                                        <p class=" btn btn-secondary">{{contadorProduto(produto)}}</p>
                                        <p class=" btn btn-info" (click)="apagarItem(produto)">-</p>
                                    </div>
                                    <div class="columns">
                                        <label for="m-0" class="text-center ml-3">Valor</label>
                                        <b><p class="m-0">{{ contadorProduto(produto) * produto.valor | currency:'BRL'}}</p></b>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="container-fluid" *ngIf="logado()">
          <div class="row justify-content-center">
              <div class="col-md-11">
                  <hr class="mt-5" style="border-top: 1px solid #3AF0A8;">
              </div>
          </div>
      </div>

        <div class="container"  *ngIf="logado()">
            <div class="row align-items-center">
                <div class="col-md-12 d-flex justify-content-center flex-row">
                    <div class="col-md-4 mb-4 mt-4">

                        <h4 class="text-center mb-3">Frete</h4>
                        <label for="cep" class="sr-only">CEP</label>
                                <input name="cep" [(ngModel)]="cep" type="text" class="form-control" id="cep"
                                    placeholder="Insira o CEP" readonly />
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="opcao1" (click)="mudafrete(10)">
                            <label class="form-check-label" for="exampleRadios1">
                              Normal
                            </label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="opcao1" (click)="mudafrete(15)">
                            <label class="form-check-label" for="exampleRadios1">
                              Expressa
                            </label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="opcao1" (click)="mudafrete(30)">
                            <label class="form-check-label" for="exampleRadios1">
                              Entrega amanhã
                            </label>
                          </div>
                        <div class="text-center">{{ valorFrete }}</div>
                    </div>
                </div>
            </div>
        </div>

        <!--/Itens do carrinho-->
        <!--Informações de pagamento-->
        <div class="container-fluid" *ngIf="logado()">
            <div class="row justify-content-center">
                <div class="col-md-11">
                    <hr class="mt-5" style="border-top: 1px solid #3AF0A8;">
                </div>
            </div>
        </div>

        <div class="col-md-12" *ngIf="logado()">
            <h4 class="text-center mt-3 mb-5">PAGAMENTO</h4>
            <div class="row d-flex justify-content-center">
                <div class="col-md-6">
                    <ul class="nav nav-tabs d-flex justify-content-center" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active text-center" id="cartao-tab" data-toggle="tab" href="#cartao"
                                role="tab" aria-controls="cartao" aria-selected="true">
                                <p class="fc-verde font-weight-bold d-md-block  teste">Cartão de Crédito </p>
                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link text-center" id="boleto-tab" data-toggle="tab" href="#boleto" role="tab"
                                aria-controls="boleto" aria-selected="false"> <i
                                    class="fas fa-receipt fc-verde icone teste"></i>
                                <p class="fc-verde font-weight-bold d-md-block teste">Boleto</p>
                            </a>
                        </li>
                    </ul>
                    <div class="tab-content mb-5" id="myTabContent">
                        <div class="tab-pane fade show active" id="cartao" role="tabpanel" aria-labelledby="cartao-tab">
                            <div class="container col-md-12">
                                <div class="col-md-12 d-flex flex-column justify-content-center">
                                    <form>
                                        <h5 class="text-center mt-5">Dados do cartão</h5>
                                        <div
                                            class="form-row d-flex justify-content-center mt-3 mb-3 fc-verde font-weight-bold">
                                            <div class="col-md-11">
                                                <label for="numeroCartao">Número do cartão</label>
                                                <input [(ngModel)]="numeroCartao" type="text" name="numeroCartao"
                                                    id="numeroCartao" class="form-control"
                                                    placeholder="Número do cartão">
                                            </div>
                                        </div>
                                        <div
                                            class="form-row d-flex justify-content-center mb-3 fc-verde font-weight-bold">
                                            <div class="col-md-11">
                                                <label for="nomeCartao">Nome</label>
                                                <input [(ngModel)]="nomeCartao" type="text" name="nomeCartao"
                                                    id="nomeCartao" class="form-control"
                                                    placeholder="Nome impresso no cartão">
                                            </div>

                                        </div>
                                        <div class="form-row d-flex justify-content-center fc-verde font-weight-bold">
                                            <div class="col-md-3">
                                                <label for="cvv">CVV</label>
                                                <input [(ngModel)]="cvv" type="text" name="cvv" id="cvv"
                                                    class="form-control" placeholder="CVV">
                                            </div>
                                            <div class="col-md-3">
                                                <label for="validade">Validade</label>
                                                <input [(ngModel)]="validade" type="text" name="validade" id="validade"
                                                    class="form-control" placeholder="00/00">
                                            </div>
                                            <div class="col-md-5">
                                                <label for="cpf">CPF</label>
                                                <input [(ngModel)]="cpf" type="text" name="cpf" id="cpf"
                                                    class="form-control" placeholder="CPF do titular" (keyup)="validaCpf()">
                                            </div>

                                        </div>
                                    </form>
                                    <div class="row d-flex justify-content-center mt-4">
                                        <div class="col-md-11 d-flex justify-content-between ">
                                            <p class="fs-16 font-weight-bold">TOTAL</p>
                                            <p class="fs-16 font-weight-bold ng"> {{ calculaTotal() | currency:'BRL' }}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="row d-flex justify-content-center">
                                        <button class="btn mt-3 btn-lg" data-toggle="modal"
                                            data-target="#modalFinalizarComprar" style="background-color:#0f2058; color:white;">
                                            Finalizar
                                            compra</button>
                                    </div>


                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="boleto" role="tabpanel" aria-labelledby="boleto-tab">
                            <div class="row d-flex justify-content-center">
                                <div class="col-md-8">


                                    <p class="text-center fs-18 font-weight-bold mt-5">Total {{ calculaTotal() |
                                        currency:'BRL'}} à vista

                                    </p>
                                    <p class="text-center fs-18 fc-verde">Prazo para pagamento do boleto: 01/06/2021</p>
                                </div>
                            </div>
                            <div class="row d-flex justify-content-center">
                                <button class="btn mt-3 btn-lg" data-toggle="modal"
                                data-target="#modalFinalizarComprarBoleto" style="background-color:#0f2058; color:white;"> Gerar
                                    boleto </button>
                            </div>

                        </div>
                    </div>
                </div>
                <!--/Informações de pagamento-->
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="modalFinalizarComprar" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel">Resumo da Compra</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="overflow-x: auto;">
                <h3>Dados Cadastrais</h3>
                <table class="table table-striped table-dark">
                    <tbody>
                        <tr>
                            <td scope="col">{{ usuario.nome }}{{ usuario.sobrenome }}</td>
                            <td scope="col">{{ usuario.cpf }}</td>
                            <td scope="col">{{ usuario.rg }}</td>
                            <td scope="col">{{ usuario.telefone }}</td>
                        </tr>
                        <tr>
                            <td scope="col">Rua {{ rua }}</td>
                            <td scope="col">{{ numero }}</td>
                            <td scope="col">{{ bairro }}</td>
                            <td scope="col">{{ cep }}</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Dados do produto</h3>
                <table class="table table-striped table-dark">
                    <tbody>
                        <tr *ngFor="let produto of produto">
                            <td scope="col">{{ produto.nome }}</td>
                            <td scope="col">{{ produto.autor }}</td>
                            <td scope="col">{{ contadorProduto(produto) }}</td>
                            <td scope="col">{{ produto.valor * contadorProduto(produto) }}</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Dados do pagamento</h3>
                <p><b>Forma de Pagamento: </b> Cartão de Crédito</p>
                <table class="table table-striped table-dark">
                    <tbody>
                        <tr>
                            <td scope="col">{{ nomeCartao }}</td>
                            <td scope="col">{{ numeroCartao }}</td>
                            <td scope="col">{{ cvv }}</td>
                            <td scope="col">{{ validade }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                <button type="button" class="btn btn-success" data-dismiss="modal" (click)="finalizarCompra()">Concluir Comprar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="modalFinalizarComprarBoleto" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLabel">Resumo da Compra</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Fechar">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="overflow-x: auto;">
                <h3>Dados Cadastrais</h3>
                <table class="table table-striped table-dark">
                    <tbody>
                        <tr>
                            <td scope="col">{{ usuario.nome }}{{ usuario.sobrenome }}</td>
                            <td scope="col">{{ usuario.cpf }}</td>
                            <td scope="col">{{ usuario.rg }}</td>
                            <td scope="col">{{ usuario.telefone }}</td>
                        </tr>
                        <tr>
                            <td scope="col">Rua {{ rua }}</td>
                            <td scope="col">{{ numero }}</td>
                            <td scope="col">{{ bairro }}</td>
                            <td scope="col">{{ cep }}</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Dados do produto</h3>
                <table class="table table-striped table-dark">
                    <tbody>
                        <tr *ngFor="let produto of produto">
                            <td scope="col">{{ produto.nome }}</td>
                            <td scope="col">{{ produto.autor }}</td>
                            <td scope="col">{{ contadorProduto(produto) }}</td>
                            <td scope="col">{{ produto.valor * contadorProduto(produto) }}</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Dados do pagamento</h3>
                <p><b>Forma de Pagamento: </b> Boleto</p>
                <table class="table table-striped table-dark">
                    <tbody>
                        <tr>
                            <td scope="col">Vencimento</td>
                            <td scope="col">01/06/2021</td>
                            <td scope="col">Enviado para</td>
                            <td scope="col">{{ usuario.emailPessoal }}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                <button type="button" class="btn btn-success"  data-dismiss="modal" (click)="finalizarCompraBoleto()">Concluir Comprar</button>
            </div>
        </div>
    </div>
</div>
